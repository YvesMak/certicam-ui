<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historique des Transactions - Certicam</title>
    <link rel="stylesheet" href="css/tokens.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/transactions.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css">
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-solid-rounded/css/uicons-solid-rounded.css">
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-bold-rounded/css/uicons-bold-rounded.css">
</head>
<body>
    <main>
        <div class="welcome-section">
            <h1>Vos transactions</h1>
        </div>

        <div class="search-section">
            <div class="search-bar">
                <div class="search-input-container">
                    <input type="text" id="transaction-search" placeholder="Rechercher par institution, émettrice, date de validité, nom du document">
                    <button id="transaction-search-clear" class="search-clear">
                        <i class="fi fi-rr-cross-small"></i>
                    </button>
                </div>
                <button class="filter-button" id="transaction-filter-toggle">
                    <i class="fi fi-br-bars-filter"></i>
                    Filtres
                </button>
            </div>

            <!-- Panel de filtres -->
            <div class="filter-panel" id="transaction-filter-panel">
                <div class="filter-panel-header">
                    <h3>Filtres</h3>
                    <button class="filter-close" id="transaction-filter-close"><i class="fi fi-br-cross-small"></i></button>
                </div>
                <div class="filter-panel-content">
                    <div class="filter-group">
                        <label class="filter-label">Statut</label>
                        <div class="filter-chips">
                            <label class="filter-chip">
                                <input type="radio" name="transaction-status-filter" value="all" checked>
                                <span class="chip-text">Tous</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-status-filter" value="valid">
                                <span class="chip-text">Réussi</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-status-filter" value="pending">
                                <span class="chip-text">En attente</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-status-filter" value="failed">
                                <span class="chip-text">Échec</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Type de paiement</label>
                        <div class="filter-chips">
                            <label class="filter-chip">
                                <input type="radio" name="transaction-payment-filter" value="all" checked>
                                <span class="chip-text">Tous</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-payment-filter" value="orange-money">
                                <span class="chip-text">Orange Money</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-payment-filter" value="mtn-momo">
                                <span class="chip-text">MTN MoMo</span>
                            </label>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Catégorie de document</label>
                        <div class="filter-chips">
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="all" checked>
                                <span class="chip-text">Toutes</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="Identité">
                                <span class="chip-text">Identité</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="Banque">
                                <span class="chip-text">Banque</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="Justice">
                                <span class="chip-text">Justice</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="Emploi">
                                <span class="chip-text">Emploi</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="Education">
                                <span class="chip-text">Education</span>
                            </label>
                            <label class="filter-chip">
                                <input type="radio" name="transaction-category-filter" value="Santé">
                                <span class="chip-text">Santé</span>
                            </label>
                        </div>
                    </div>

                    <div class="filter-actions">
                        <button class="btn-secondary" id="transaction-reset-filters">Réinitialiser</button>
                        <button class="btn-primary" id="transaction-apply-filters">Appliquer</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="transactions-section">
            <div class="transactions-table-wrapper">
                <table class="transactions-table" id="transactions-table">
                    <thead>
                        <tr>
                            <th>Transaction</th>
                            <th>Document/Produit</th>
                            <th>Institution émettrice</th>
                            <th>Type de paiement</th>
                            <th>Montant</th>
                            <th>Statut</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">5423</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">Relevé bancaire</span>
                                    <span class="document-category">Banque</span>
                                </div>
                            </td>
                            <td>Banque XYZ</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1500 FCFA</td>
                            <td><span class="status valid">Réussite</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="5423">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la facture
                                        </button>
                                        <button class="dropdown-item download-receipt">
                                            <i class="fi fi-rr-download"></i>
                                            Télécharger le reçu
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">6534</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status pending">En cours</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="6534">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la transaction
                                        </button>
                                        <button class="dropdown-item cancel-transaction">
                                            <i class="fi fi-rr-cross"></i>
                                            Annuler la transaction
                                        </button>
                                        <button class="dropdown-item contact-support">
                                            <i class="fi fi-rr-envelope"></i>
                                            Contacter le support
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">9823</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status failed">Échec</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="9823">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la transaction
                                        </button>
                                        <button class="dropdown-item retry-payment">
                                            <i class="fi fi-rr-refresh"></i>
                                            Relancer le paiement
                                        </button>
                                        <button class="dropdown-item contact-support">
                                            <i class="fi fi-rr-envelope"></i>
                                            Contacter le support
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">8734</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status valid">Réussite</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="8734">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la facture
                                        </button>
                                        <button class="dropdown-item download-receipt">
                                            <i class="fi fi-rr-download"></i>
                                            Télécharger le reçu
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">5143</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status valid">Réussite</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="5143">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la facture
                                        </button>
                                        <button class="dropdown-item download-receipt">
                                            <i class="fi fi-rr-download"></i>
                                            Télécharger le reçu
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">9082</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status valid">Réussite</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="9082">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la facture
                                        </button>
                                        <button class="dropdown-item download-receipt">
                                            <i class="fi fi-rr-download"></i>
                                            Télécharger le reçu
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">6237</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status valid">Réussite</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="6237">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la facture
                                        </button>
                                        <button class="dropdown-item download-receipt">
                                            <i class="fi fi-rr-download"></i>
                                            Télécharger le reçu
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="transaction-info">
                                    <span class="transaction-number">4502</span>
                                    <span class="transaction-date">12 Mai 2025</span>
                                </div>
                            </td>
                            <td>
                                <div class="document-info">
                                    <span class="document-name">CNI</span>
                                    <span class="document-category">Identité</span>
                                </div>
                            </td>
                            <td>DGSN</td>
                            <td class="payment-type">
                                <img src="img/orange-logo.png" alt="Orange Money" class="payment-logo">
                                Orange Money
                            </td>
                            <td class="amount">1000 FCFA</td>
                            <td><span class="status valid">Réussite</span></td>
                            <td class="actions">
                                <div class="dropdown">
                                    <button class="action-button dropdown-toggle" data-transaction="4502">
                                        <i class="fi fi-rr-menu-dots-vertical"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <button class="dropdown-item view-receipt">
                                            <i class="fi fi-rr-eye"></i>
                                            Voir la facture
                                        </button>
                                        <button class="dropdown-item download-receipt">
                                            <i class="fi fi-rr-download"></i>
                                            Télécharger le reçu
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <div class="rows-per-page">
                    <div class="selector-wrapper">
                        <span class="current-selection">8 documents</span>
                        <button class="rows-selector">
                            <i class="fi fi-rr-angle-small-down"></i>
                        </button>
                        <div class="selector-dropdown">
                            <div class="dropdown-item" data-value="5">5 documents</div>
                            <div class="dropdown-item" data-value="8">8 documents</div>
                            <div class="dropdown-item" data-value="15">15 documents</div>
                            <div class="dropdown-item" data-value="25">25 documents</div>
                            <div class="dropdown-item" data-value="50">50 documents</div>
                        </div>
                    </div>
                </div>
                <div class="pagination-controls">
                    <div class="page-numbers">
                        <span class="active">1</span>
                        <span>2</span>
                        <span>3</span>
                        <span class="dots">...</span>
                        <span>8</span>
                        <span>9</span>
                        <span>10</span>
                    </div>
                </div>
                <div class="pagination-buttons">
                    <button class="prev-button">
                        <i class="fi fi-rr-angle-small-left"></i>
                        Précédent
                    </button>
                    <button class="next-button">
                        Suivant
                        <i class="fi fi-rr-angle-small-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal de facture -->
    <div class="modal-overlay" id="receipt-modal">
        <div class="modal receipt-modal">
            <div class="modal-header">
                <h2>Facture de transaction</h2>
                <button class="modal-close" id="receipt-modal-close"><i class="fi fi-br-cross-small"></i></button>
            </div>
            <div class="modal-content">
                <div class="receipt-content">
                    <div class="receipt-header">
                        <div class="receipt-logo">
                            <img src="img/certicam-main-logo.png" alt="Certicam Logo">
                        </div>
                        <div class="receipt-info">
                            <h3>REÇU DE PAIEMENT</h3>
                            <p class="receipt-number">N° <span id="receipt-transaction-number"></span></p>
                            <p class="receipt-date">Date: <span id="receipt-transaction-date"></span></p>
                        </div>
                    </div>
                    
                    <div class="receipt-details">
                        <div class="detail-row">
                            <span class="detail-label">Produit:</span>
                            <span class="detail-value" id="receipt-product"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Type de paiement:</span>
                            <span class="detail-value" id="receipt-payment-type"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Montant:</span>
                            <span class="detail-value amount" id="receipt-amount"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Statut:</span>
                            <span class="detail-value" id="receipt-status"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Client:</span>
                            <span class="detail-value">Coco - Utilisateur Certicam</span>
                        </div>
                    </div>
                    
                    <div class="receipt-footer">
                        <div class="receipt-total">
                            <strong>Total payé: <span id="receipt-total"></span></strong>
                        </div>
                        <div class="receipt-signature">
                            <p>Merci pour votre confiance</p>
                            <p class="company-info">Certicam - Certification numérique</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="receipt-modal-close-btn">Fermer</button>
                <button class="btn-primary" id="download-receipt-btn">
                    <i class="fi fi-rr-download"></i>
                    Télécharger PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmation d'action -->
    <div class="modal-overlay" id="action-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-title">Confirmer l'action</h3>
                <button class="modal-close" id="modal-close">
                    <i class="fi fi-rr-cross-small"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="modal-message">Êtes-vous sûr de vouloir effectuer cette action ?</p>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="modal-cancel">Annuler</button>
                <button class="btn-primary" id="modal-confirm">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Modale moderne pour voir la facture -->
    <div id="receiptModal" class="modal-overlay">
        <div class="modal receipt-modal">
            <div class="modal-header">
                <h3 class="modal-title">Facture de transaction</h3>
                <button class="modal-close" id="receiptModalClose" type="button" aria-label="Fermer la modal">
                    <i class="fi fi-rr-cross"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="receipt-content">
                    <!-- En-tête avec logo -->
                    <div class="receipt-header">
                        <div class="receipt-logo">
                            <img src="img/certicam-main-logo.png" alt="Certicam" loading="lazy">
                        </div>
                        <div class="receipt-info">
                            <h4 class="receipt-title">Reçu de paiement</h4>
                            <p class="receipt-number">Facture #<span id="receiptNumber">TXN-5423</span></p>
                            <p class="receipt-date">Date: <span id="receiptDate">12 Mai 2025</span></p>
                        </div>
                    </div>

                    <!-- Détails de la transaction -->
                    <div class="receipt-details">
                        <div class="detail-row">
                            <span class="detail-label">Service</span>
                            <span class="detail-value" id="receiptService">Relevé bancaire</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Institution</span>
                            <span class="detail-value" id="receiptInstitution">Banque XYZ</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Mode de paiement</span>
                            <span class="detail-value" id="receiptPayment">Orange Money</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Statut</span>
                            <span class="detail-value" id="receiptStatus">
                                <span class="status success">Réussi</span>
                            </span>
                        </div>
                        <div class="detail-row total-row">
                            <span class="detail-label">Montant total</span>
                            <span class="detail-value amount-total" id="receiptAmount">1500 FCFA</span>
                        </div>
                    </div>

                    <!-- Pied de page -->
                    <div class="receipt-footer">
                        <div class="receipt-signature">
                            <p class="company-name"><strong>Certicam</strong></p>
                            <p class="company-info">Plateforme de certification de documents officiels</p>
                            <p class="company-info">contact@certicam.com | +237 XXX XXX XXX</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" id="closeReceiptModal" type="button">
                    <i class="fi fi-rr-cross-small"></i>
                    Fermer
                </button>
                <button class="btn btn-primary" id="downloadReceipt" type="button">
                    <i class="fi fi-rr-download"></i>
                    Télécharger
                </button>
            </div>
        </div>
    </div>

    <!-- Modale de confirmation pour les actions -->
    <div id="actionModal" class="modal-overlay">
        <div class="modal action-modal">
            <div class="modal-header">
                <h3 id="actionModalTitle">Confirmer l'action</h3>
                <button class="modal-close" id="actionModalClose">
                    <i class="fi fi-rr-cross"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <p id="actionModalMessage">Êtes-vous sûr de vouloir effectuer cette action ?</p>
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" id="cancelAction">Annuler</button>
                <button class="btn-primary" id="confirmAction">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="js/certicam-init.js"></script>
    <script>
        // Marquer la page transactions comme active quand la navbar est chargée
        document.addEventListener('navbarLoaded', () => {
            if (window.Certicam) {
                window.Certicam.setActivePage('transactions.html');
            }
        });
    </script>
    <script src="js/transactions.js"></script>
</body>
</html>
